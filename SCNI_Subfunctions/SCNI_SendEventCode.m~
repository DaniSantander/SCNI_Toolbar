function SCNI_SendEventCode(event, Params)

%========================== SCNI_SendEventCode.m ==========================
% Sends the provided event code number to the appropriate neurophysiology
% recording system(s). 
%
% EXAMPLE:
%   Params.EventCodes  = SCNI_LoadEventCodes;       % Load standard event codes
%   Params      = SCNI_TDTSettings(Params, 0);      
%   event       = 'Fix_on';
%   Success     = SCNISendEventCode(EventNum, Params);
%
%==========================================================================

if isdouble(event)
    EventNumber     = event;
    EventString     = num2str(event);
elseif ischar(event)
    if ~isfield(Params,'EventCodes')
        Params.EventCodes  = SCNI_LoadEventCodes;
    end
    EventString     = event;
    EventNumber     = find(~cellfun(@isempty, strfind(lower({EventCodes.String}), lower(event))));
    if isempty(EventNumber)
        error('''%s'' is not a recognized event string!', event)
    end
end

%================= Send event number to TDT over digital output
if isfield(Params,'TDT') && Params.TDT.Enabled == 1
    SCNI_SetBitsTDT(EventNumber);
end

%================= Send event string to OpenEphys over ethernet
if isfield(Params,'OE') && Params.OE.Enabled == 1
    if ~isfield(Params.OE, 'handle')
        error('Handle to ZeroMQ connection must be provided in ''Params.OE.handle''!');
    end
    zeroMQwrapper('Send', Params.OE.handle, EventString);
end